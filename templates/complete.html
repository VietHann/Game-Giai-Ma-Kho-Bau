{% extends "base.html" %}

{% block title %}Ho√†n Th√†nh - Tr√≤ Ch∆°i Gi·∫£i M√£ Kho B√°u{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="completion-card text-center">
                <div class="card-body p-5">
                    <!-- Celebration Animation -->
                    <div class="celebration-animation mb-4">
                        <i class="fas fa-trophy celebration-trophy"></i>
                        <div class="confetti">
                            <div class="confetti-piece"></div>
                            <div class="confetti-piece"></div>
                            <div class="confetti-piece"></div>
                            <div class="confetti-piece"></div>
                            <div class="confetti-piece"></div>
                        </div>
                    </div>
                    
                    <!-- Congratulations -->
                    <h1 class="pirata-font text-primary mb-3">
                        üéâ Congratulations! üéâ
                    </h1>
                    <h2 class="mb-4">B·∫°n ƒê√£ T√¨m Th·∫•y Kho B√°u!</h2>
                    
                    <!-- Success Message -->
                    <div class="success-message mb-4">
                        <p class="lead">
                            Xu·∫•t s·∫Øc! B·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ 4 c·∫•p ƒë·ªô v√† th√†nh th·∫°o 
                            c√°c thu·∫≠t to√°n m√£ h√≥a c∆° b·∫£n. Kho b√°u cu·ªëi c√πng ƒë√£ thu·ªôc v·ªÅ b·∫°n!
                        </p>
                    </div>
                    
                    <!-- Final Score -->
                    <div class="final-score mb-4">
                        <div class="score-circle">
                            <div class="score-number">{{ game_state.score }}</div>
                            <div class="score-label">ƒêi·ªÉm Cu·ªëi</div>
                        </div>
                    </div>
                    
                    <!-- Achievement Stats -->
                    <div class="achievement-stats mb-4">
                        <div class="row g-3">
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <i class="fas fa-check-circle text-success"></i>
                                    <h5>{{ game_state.completed_levels|length }}/4</h5>
                                    <p>C·∫•p ƒë·ªô ho√†n th√†nh</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <i class="fas fa-redo text-info"></i>
                                    <h5>{{ game_state.attempts }}</h5>
                                    <p>L·∫ßn th·ª≠</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <i class="fas fa-lightbulb text-warning"></i>
                                    <h5>{{ game_state.hints_used }}</h5>
                                    <p>G·ª£i √Ω s·ª≠ d·ª•ng</p>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="stat-card">
                                    <i class="fas fa-shield-alt text-primary"></i>
                                    <h5>4</h5>
                                    <p>Thu·∫≠t to√°n ƒë√£ h·ªçc</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Achievement Badges -->
                    <div class="achievement-badges mb-4">
                        <h5>Th√†nh T√≠ch ƒê·∫°t ƒê∆∞·ª£c:</h5>
                        <div class="badges-row">
                            <span class="achievement-badge">
                                <i class="fas fa-graduation-cap"></i>
                                Nh√† Vua C·ªßa Tr√≤ Ch∆°i
                            </span>
                            <span class="achievement-badge">
                                <i class="fas fa-key"></i>
                                Chuy√™n Gia Gi·∫£i M√£
                            </span>
                            <span class="achievement-badge">
                                <i class="fas fa-treasure-chest"></i>
                                Th·ª£ SƒÉn Kho B√°u
                            </span>
                            {% if game_state.hints_used == 0 %}
                            <span class="achievement-badge special">
                                <i class="fas fa-brain"></i>
                                Thi√™n T√†i T·ª± H·ªçc
                            </span>
                            {% endif %}
                            {% if game_state.score >= 600 %}
                            <span class="achievement-badge special">
                                <i class="fas fa-star"></i>
                                ƒêi·ªÉm S·ªë Ho√†n H·∫£o
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Learning Summary -->
                    <div class="learning-summary mb-4">
                        <h5>B·∫°n ƒê√£ H·ªçc ƒê∆∞·ª£c:</h5>
                        <div class="row g-2">
                            <div class="col-md-6">
                                <div class="learned-item">
                                    <i class="fas fa-font text-primary"></i>
                                    <strong>Caesar Cipher:</strong> M√£ h√≥a d·ªãch chuy·ªÉn c∆° b·∫£n
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="learned-item">
                                    <i class="fas fa-key text-success"></i>
                                    <strong>Vigen√®re Cipher:</strong> M√£ h√≥a v·ªõi t·ª´ kh√≥a
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="learned-item">
                                    <i class="fas fa-lock text-warning"></i>
                                    <strong>RSA:</strong> M√£ h√≥a kh√≥a c√¥ng khai
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="learned-item">
                                    <i class="fas fa-shield-alt text-danger"></i>
                                    <strong>AES:</strong> Chu·∫©n m√£ h√≥a hi·ªán ƒë·∫°i
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="action-buttons">
                        <a href="{{ url_for('reset_game') }}" class="btn btn-primary btn-lg me-3">
                            <i class="fas fa-redo me-2"></i>Ch∆°i L·∫°i
                        </a>
                        <a href="{{ url_for('index') }}" class="btn btn-outline-primary btn-lg">
                            <i class="fas fa-home me-2"></i>Trang Ch·ªß
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Fireworks Effect -->
<div class="fireworks">
    <div class="firework"></div>
    <div class="firework"></div>
    <div class="firework"></div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Add some celebration effects
document.addEventListener('DOMContentLoaded', function() {
    // Animate trophy
    const trophy = document.querySelector('.celebration-trophy');
    if (trophy) {
        trophy.style.animation = 'bounce 2s infinite';
    }
    
    // Add sparkle effect
    setTimeout(() => {
        createSparkles();
    }, 1000);
});

function createSparkles() {
    for (let i = 0; i < 20; i++) {
        setTimeout(() => {
            const sparkle = document.createElement('div');
            sparkle.className = 'sparkle';
            sparkle.style.left = Math.random() * 100 + '%';
            sparkle.style.top = Math.random() * 100 + '%';
            sparkle.innerHTML = '‚ú®';
            document.body.appendChild(sparkle);
            
            setTimeout(() => {
                if (sparkle.parentNode) {
                    sparkle.parentNode.removeChild(sparkle);
                }
            }, 3000);
        }, i * 200);
    }
}
</script>
{% endblock %}
